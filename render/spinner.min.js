Spinner=function(a,b){b=b||{},this.element=this.create(b.x||"50%",b.y||"50%",b.color),b.showCurtain&&(this.curtain=this.createCurtain()),this.removeSelf=this.removeSelfFunc(this.curtain),this.element.firstChild.addEventListener("webkitTransitionEnd",this.removeSelf,!1),this.element.firstChild.addEventListener("msTransitionEnd",this.removeSelf,!1),this.element.firstChild.addEventListener("oTransitionEnd",this.removeSelf,!1),this.element.firstChild.addEventListener("transitionend",this.removeSelf,!1),this.container=a,this.container.appendChild(this.element)},Spinner.prototype={start:function(){var a=this;setTimeout(function(){a.show()},0)},show:function(){if(this.element.firstChild.className="spinner-bringIn",this.curtain){var a=this;this.container.insertBefore(this.curtain,this.container.firstChild),this.curtain.style.opacity=0,setTimeout(function(){a.curtain.style.opacity=.5},0)}},hide:function(){this.element.firstChild.className="spinner-bringOut",this.curtain&&(this.curtain.style.opacity=0)},create:function(a,b,c){var d=document.createElement("div");d.className="spinner-bringOut",d.style.position="absolute",d.style.marginLeft="-25px",d.style.marginTop="-25px",d.style.left=a,d.style.top=b;var e=document.createElement("canvas");e.className="spinner",e.width=e.height=50;var f=e.getContext("2d");f.lineWidth=4,null!=c&&(f.strokeStyle=c);for(var g=2*Math.PI/3,h=0;h<3;h++)f.beginPath(),f.arc(25,25,20,h*g,h*g+Math.PI/2,!1),f.stroke();d.appendChild(e);var i=document.createElement("div");return i.className="spinner-container",i.appendChild(d),i},createCurtain:function(){var a=document.createElement("div");return a.className="spinner-curtain",a},removeSelfFunc:function(a){var b=this;return function(c){c.target==this&&"opacity"==c.propertyName&&(this.parentNode&&"spinner-bringOut"==this.className?(b.onhide&&b.onhide(),a&&a.parentNode.removeChild(a)):"spinner-bringIn"==this.className&&b.onshow&&b.onshow())}}};